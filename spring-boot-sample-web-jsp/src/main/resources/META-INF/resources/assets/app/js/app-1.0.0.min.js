/*! issue-tracker-ui 2015-11-21 */

Backbone.Marionette.Renderer.render=function(a,b){return IssueTrackerTemplates[a](b)},window.IssueTrackerApp=new Backbone.Marionette.Application,IssueTrackerApp.addRegions({headerRegion:"#header-region",mainRegion:"#main-region",dialogRegion:"#dialog-region",footerRegion:"#footer-region"}),IssueTrackerApp.on("start",function(a){logger.debug("Backbone.history.start"),Backbone.history.start(),""===IssueTrackerApp.getCurrentRoute()&&IssueTrackerApp.execute("issuemanager:list")}),IssueTrackerApp.navigate=function(a,b){logger.debug("IssueTrackerApp.navigate route:"+a),b=b||{},Backbone.history.navigate(a,b)},IssueTrackerApp.getCurrentRoute=function(){return Backbone.history.fragment},$(function(){window.logger=log4javascript.getLogger(),consoleAppender=new log4javascript.BrowserConsoleAppender,consoleAppender.setLayout(new log4javascript.PatternLayout("%d{HH:mm:ss} %-5p- %m")),window.logger.addAppender(consoleAppender),logger.debug("IssueTrackerApp.start"),IssueTrackerApp.start()}),IssueTrackerApp.module("Entities",function(a,b,c,d,e,f){a.Issue=c.Model.extend({urlRoot:"http://localhost:28080/issues",defaults:{status:"OPEN"},validate:function(a,b){var c={};return a.title||(c.title="Title is required."),a.description||(c.description="Description is required."),a.type||(c.type="Type is required."),a.priority||(c.priority="Priority is required."),f.isEmpty(c)?void 0:c}}),a.IssueCollection=c.Collection.extend({model:a.Issue,url:"http://localhost:28080/issues"});var g=d.Controller.extend({getIssues:function(){logger.debug("IssueEntityController.getIssues");var b=new a.IssueCollection,c=e.Deferred();return b.fetch({success:function(a){c.resolve(a)}}),c.promise()}}),h=new g;b.reqres.setHandler("issue:entities",function(){return logger.debug("Manejando request issue:entities"),h.getIssues()})}),IssueTrackerApp.module("Footer",function(a,b,c,d,e,f){var g=d.Controller.extend({show:function(){logger.debug("FooterController.show");var c=new a.FooterView;b.footerRegion.show(c)}}),h=new g;a.addInitializer(function(){logger.debug("Footer initializer"),h.show()})}),IssueTrackerApp.module("Footer",function(a,b,c,d,e,f){a.FooterView=c.Marionette.ItemView.extend({className:"container-fluid",template:"footer"})}),IssueTrackerApp.module("Header",function(a,b,c,d,e,f){var g=d.Controller.extend({show:function(){logger.debug("HeaderController.show");var c=new a.NavBarView;b.headerRegion.show(c)}}),h=new g;a.addInitializer(function(){logger.debug("Header initializer"),h.show()})}),IssueTrackerApp.module("Header",function(a,b,c,d,e,f){a.NavBarView=c.Marionette.ItemView.extend({template:"navbar"})}),IssueTrackerApp.module("IssueManager",function(a,b,c,d,e,f){var g=d.AppRouter.extend({appRoutes:{issues:"list"}}),h=d.Controller.extend({list:function(c){logger.debug("IssueManagerController.list");var d=function(c){var d=new a.IssueListView({collection:c});logger.debug("Show listView in IssueTrackerApp.mainRegion"),b.mainRegion.show(d)};if(c)d(c);else{var f=b.request("issue:entities");e.when(f).done(function(a){d(a)})}},add:function(){logger.debug("IssueManagerController.add");var c=new a.IssueAddView;c.on("form:cancel",function(){logger.debug("Handling 'form:cancel' event"),b.execute("issuemanager:list")}),c.on("form:submit",function(a){logger.debug("Handling 'form:submit' event"),logger.debug("form data:"+JSON.stringify(a));var d=new b.Entities.Issue;d.save(a,{success:function(){b.execute("issuemanager:list")},error:function(){alert("An unexpected problem has occurred.")}})||c.triggerMethod("form:validation:failed",d.validationError)}),logger.debug("Show IssueAddView in IssueTrackerApp.mainRegion"),b.mainRegion.show(c)}}),i=new h;a.addInitializer(function(){logger.debug("IssueManager initializer");new g({controller:i})}),b.commands.setHandler("issuemanager:list",function(a){logger.debug("Handling 'issuemanager:list' command"),b.navigate("issues"),i.list(a)}),b.commands.setHandler("issuemanager:add",function(){logger.debug("Handling 'issuemanager:add' command"),i.add()})}),IssueTrackerApp.module("IssueManager",function(a,b,c,d,e,f){a.IssueListEmptyView=c.Marionette.ItemView.extend({tagName:"tr",template:"issuelistempty"}),a.IssueListItemView=c.Marionette.ItemView.extend({tagName:"tr",template:"issuelistitem"}),a.IssueListView=c.Marionette.CompositeView.extend({emptyView:a.IssueListEmptyView,childView:a.IssueListItemView,childViewContainer:"tbody",className:"container-fluid",template:"issuelist"}),a.IssueAddView=c.Marionette.ItemView.extend({className:"container-fluid",template:"issueadd",ui:{createButton:"button.js-create",cancelButton:"button.js-cancel"},events:{"click @ui.createButton":"onCreateClicked"},triggers:{"click @ui.cancelButton":"form:cancel"},onCreateClicked:function(a){logger.debug("IssueAddView.onCreateClicked"),a.preventDefault(),this.showProcessingState();var b=c.Syphon.serialize(this);this.trigger("form:submit",b)},showProcessingState:function(){var a='<i class="fa fa-circle-o-notch fa-spin"></i> ';this.ui.createButton.button("loading"),this.ui.createButton.prepend(a)},hideProcessingState:function(){this.ui.createButton.button("reset")},onFormValidationFailed:function(a){this.hideProcessingState(),this.hideFormErrors(),f.each(a,this.showFormError,this)},showFormError:function(a,b){var c=this.$el.find('[name="'+b+'"]'),d=c.parents(".form-group"),e='<span class="help-block js-form-error">'+a+"</span>";c.after(e),d.addClass("has-error")},hideFormErrors:function(){this.$el.find(".js-form-error").each(function(){e(this).remove()}),this.$el.find(".form-group.has-error").each(function(){e(this).removeClass("has-error")})}})});
//# sourceMappingURL=app-1.0.0.map